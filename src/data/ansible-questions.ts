import { Question } from '@/types/game';

const wrongFeedbackPool = [
  "Oops! That would definitely page the on-call team at 3 AM ðŸ˜…",
  "Nice try! But production would be crying right now ðŸ˜­",
  "A real DevOps engineer fails fast and learns faster ðŸš€",
  "Close! But that's how you get a Slack message at dinner ðŸ",
  "Hmm, that's how incidents start... ðŸš¨",
  "Your future self would debug this for hours ðŸ•",
  "The logs would be very confused right now ðŸ“œ",
  "That's a spicy way to break things! ðŸŒ¶ï¸",
  "Production would like to have a word with you ðŸ’¬",
  "Stack Overflow would judge you for this one ðŸ‘€",
];

const getRandomWrongFeedback = (): string[] => {
  const shuffled = [...wrongFeedbackPool].sort(() => 0.5 - Math.random());
  return shuffled.slice(0, 3);
};

export const ansibleQuestions: Question[] = [
  // ============ LEVEL 6: ANSIBLE AUTOMATOR ============
  {
    id: 'ansible-1',
    levelId: 'ansible',
    difficulty: 'easy',
    question: 'What is Ansible primarily used for?',
    options: [
      'Configuration management and automation',
      'Container orchestration',
      'Code compilation',
      'Database management',
    ],
    correctAnswer: 0,
    explanation: 'Ansible is an open-source tool for configuration management, application deployment, and task automation.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 10,
    tags: ['basics', 'concepts', 'fundamentals'],
  },
  {
    id: 'ansible-2',
    levelId: 'ansible',
    difficulty: 'easy',
    question: 'What language are Ansible playbooks written in?',
    options: ['JSON', 'XML', 'Python', 'YAML'],
    correctAnswer: 3,
    explanation: 'Ansible playbooks are written in YAML (YAML Ain\'t Markup Language), making them human-readable.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 10,
    tags: ['playbooks', 'syntax', 'basics'],
  },
  {
    id: 'ansible-3',
    levelId: 'ansible',
    difficulty: 'easy',
    question: 'What is an Ansible inventory?',
    options: [
      'A log of executed tasks',
      'A backup of configurations',
      'A file defining hosts and groups to manage',
      'A list of available modules',
    ],
    correctAnswer: 2,
    explanation: 'The inventory file defines the hosts and groups of hosts that Ansible will manage.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 10,
    tags: ['inventory', 'hosts', 'basics'],
  },
  {
    id: 'ansible-4',
    levelId: 'ansible',
    difficulty: 'easy',
    question: 'Which protocol does Ansible primarily use to connect to remote hosts?',
    options: ['FTP', 'Telnet', 'SSH', 'HTTP'],
    correctAnswer: 2,
    explanation: 'Ansible uses SSH for Linux/Unix hosts and WinRM for Windows hosts, with SSH being the primary method.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 10,
    tags: ['connectivity', 'ssh', 'basics'],
  },
  {
    id: 'ansible-5',
    levelId: 'ansible',
    difficulty: 'easy',
    question: 'What is an Ansible module?',
    options: [
      'A configuration file',
      'A reusable unit of code that performs a specific task',
      'A type of inventory',
      'A logging system',
    ],
    correctAnswer: 1,
    explanation: 'Modules are the units of code Ansible executes. Examples include apt, yum, copy, file, and service.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 10,
    tags: ['modules', 'concepts', 'basics'],
  },
  {
    id: 'ansible-6',
    levelId: 'ansible',
    difficulty: 'medium',
    question: 'What does idempotency mean in Ansible?',
    options: [
      'Tasks run in parallel',
      'Running the same playbook multiple times produces the same result',
      'Tasks are encrypted',
      'Playbooks are version controlled',
    ],
    correctAnswer: 1,
    explanation: 'Idempotency means running the same operation multiple times has the same effect as running it once - Ansible only makes changes when needed.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['concepts', 'best-practices', 'intermediate'],
  },
  {
    id: 'ansible-7',
    levelId: 'ansible',
    difficulty: 'medium',
    question: 'What is an Ansible role?',
    options: [
      'A user permission level',
      'A way to organize playbooks into reusable components',
      'A type of variable',
      'A connection method',
    ],
    correctAnswer: 1,
    explanation: 'Roles are a way to organize playbooks and related files (tasks, handlers, variables, templates) into reusable components.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['roles', 'organization', 'intermediate'],
  },
  {
    id: 'ansible-8',
    levelId: 'ansible',
    difficulty: 'medium',
    question: 'How do you define a variable in an Ansible playbook?',
    code: '# Define a variable named "app_port"',
    options: [
      'set app_port = 8080',
      'vars:\\n  app_port: 8080',
      'variable app_port: 8080',
      '$app_port = 8080',
    ],
    correctAnswer: 1,
    explanation: 'Variables in Ansible are defined under the vars: section using YAML key-value syntax.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['variables', 'syntax', 'intermediate'],
  },
  {
    id: 'ansible-9',
    levelId: 'ansible',
    difficulty: 'medium',
    question: 'What is the purpose of handlers in Ansible?',
    options: [
      'To handle errors in playbooks',
      'To run tasks only when notified by other tasks',
      'To manage SSH connections',
      'To parse inventory files',
    ],
    correctAnswer: 1,
    explanation: 'Handlers are special tasks that run only when notified by other tasks, typically used for restarting services after config changes.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['handlers', 'tasks', 'intermediate'],
  },
  {
    id: 'ansible-10',
    levelId: 'ansible',
    difficulty: 'medium',
    question: 'Which command runs a playbook in check mode (dry run)?',
    options: [
      'ansible-playbook playbook.yml --dry-run',
      'ansible-playbook playbook.yml --check',
      'ansible-playbook playbook.yml --test',
      'ansible-playbook playbook.yml --simulate',
    ],
    correctAnswer: 1,
    explanation: 'The --check flag runs the playbook in check mode, showing what would change without making actual changes.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['commands', 'testing', 'intermediate'],
  },
  {
    id: 'ansible-11',
    levelId: 'ansible',
    difficulty: 'medium',
    question: 'What is Ansible Vault used for?',
    options: [
      'Storing playbook backups',
      'Encrypting sensitive data like passwords',
      'Managing Docker containers',
      'Version control for playbooks',
    ],
    correctAnswer: 1,
    explanation: 'Ansible Vault encrypts sensitive data (passwords, keys, secrets) within playbooks and variable files.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['vault', 'security', 'intermediate'],
  },
  {
    id: 'ansible-12',
    levelId: 'ansible',
    difficulty: 'hard',
    question: 'What is the correct way to use a Jinja2 template in Ansible?',
    code: '# Deploy a config file from template',
    options: [
      'copy: src=template.conf dest=/etc/app.conf',
      'template: src=template.conf.j2 dest=/etc/app.conf',
      'file: template=template.conf path=/etc/app.conf',
      'jinja: input=template.conf output=/etc/app.conf',
    ],
    correctAnswer: 1,
    explanation: 'The template module processes Jinja2 templates (.j2 files) and copies them to the destination with variables substituted.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['templates', 'jinja2', 'advanced'],
  },
  {
    id: 'ansible-13',
    levelId: 'ansible',
    difficulty: 'hard',
    question: 'How do you loop over a list of items in an Ansible task?',
    code: '# Install multiple packages',
    options: [
      'foreach: packages',
      'loop: "{{ packages }}"',
      'iterate: packages',
      'for item in packages:',
    ],
    correctAnswer: 1,
    explanation: 'The loop keyword iterates over a list, making each item available as {{ item }} in the task.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['loops', 'iteration', 'advanced'],
  },
  {
    id: 'ansible-14',
    levelId: 'ansible',
    difficulty: 'hard',
    question: 'What is the difference between "include_tasks" and "import_tasks"?',
    options: [
      'No difference, they are aliases',
      'include_tasks is dynamic (runtime), import_tasks is static (parse time)',
      'include_tasks for roles, import_tasks for playbooks',
      'import_tasks is deprecated',
    ],
    correctAnswer: 1,
    explanation: 'import_tasks is static (processed at playbook parse time), include_tasks is dynamic (processed at runtime), affecting conditionals and loops.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['includes', 'imports', 'advanced'],
  },
  {
    id: 'ansible-15',
    levelId: 'ansible',
    difficulty: 'hard',
    question: 'How do you run a task only on specific hosts from your inventory?',
    options: [
      'hosts: specific_host',
      'when: inventory_hostname == "specific_host"',
      'target: specific_host',
      'Both A and B can work depending on context',
    ],
    correctAnswer: 3,
    explanation: 'You can target hosts with "hosts:" at play level, or use "when:" conditions with inventory_hostname for task-level control.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['targeting', 'conditionals', 'advanced'],
  },
  {
    id: 'ansible-16',
    levelId: 'ansible',
    difficulty: 'hard',
    question: 'What does "gather_facts: false" do in a playbook?',
    options: [
      'Disables variable collection',
      'Skips automatic system information gathering to speed up execution',
      'Prevents logging',
      'Disables error reporting',
    ],
    correctAnswer: 1,
    explanation: 'gather_facts: false skips the setup module that collects system facts, significantly speeding up playbook execution when facts aren\'t needed.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['facts', 'optimization', 'advanced'],
  },
  {
    id: 'ansible-17',
    levelId: 'ansible',
    difficulty: 'hard',
    question: 'How do you register the output of a task for later use?',
    code: '- name: Check service status\\n  command: systemctl status nginx',
    options: [
      'output: nginx_status',
      'register: nginx_status',
      'save_result: nginx_status',
      'store: nginx_status',
    ],
    correctAnswer: 1,
    explanation: 'The register keyword captures task output (stdout, stderr, rc, etc.) into a variable for use in subsequent tasks.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['register', 'variables', 'advanced'],
  },
  {
    id: 'ansible-18',
    levelId: 'ansible',
    difficulty: 'evil',
    question: 'Your Ansible playbook works locally but fails in CI with "Permission denied". The playbook uses become: yes. What\'s the MOST likely issue?',
    options: [
      'Wrong Python version',
      'Missing NOPASSWD in sudoers or no password provided for become',
      'SSH key not found',
      'Inventory file syntax error',
    ],
    correctAnswer: 1,
    explanation: 'When become: yes is used, Ansible needs sudo access. In CI, you often need NOPASSWD configured or to provide become_pass.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 50,
    tags: ['debugging', 'ci-cd', 'evil'],
  },
  {
    id: 'ansible-19',
    levelId: 'ansible',
    difficulty: 'evil',
    question: 'Interview: How would you structure an Ansible project for managing 500+ servers across dev, staging, and production?',
    options: [
      'One playbook file with all tasks',
      'Separate inventory per environment, roles for components, group_vars for environment-specific config',
      'Separate Git repository for each server',
      'Use shell scripts instead, Ansible doesn\'t scale well',
    ],
    correctAnswer: 1,
    explanation: 'Best practice: Use inventory per environment, organize with roles, use group_vars/host_vars for config, and leverage Ansible Galaxy for reusable roles.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 50,
    tags: ['architecture', 'interview', 'evil'],
  },
  {
    id: 'ansible-20',
    levelId: 'ansible',
    difficulty: 'evil',
    question: 'A task with "changed_when: false" still reports as changed. What could cause this?',
    options: [
      'Syntax error in the playbook',
      'A handler was notified',
      'The module doesn\'t respect changed_when',
      'changed_when only works in check mode',
    ],
    correctAnswer: 2,
    explanation: 'Some modules (especially command/shell) always report changed. changed_when overrides this, but if you see changed despite it, check if a different task or the module itself has issues.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 50,
    tags: ['debugging', 'modules', 'evil'],
  },
  {
    id: 'ansible-21',
    levelId: 'ansible',
    difficulty: 'medium',
    question: 'What is the default location for the Ansible inventory file?',
    options: [
      '/etc/ansible/hosts',
      '/var/ansible/inventory',
      '~/.ansible/inventory',
      '/opt/ansible/hosts',
    ],
    correctAnswer: 0,
    explanation: '/etc/ansible/hosts is the default inventory location, but you can specify a different file with -i flag.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['inventory', 'configuration', 'intermediate'],
  },
  {
    id: 'ansible-22',
    levelId: 'ansible',
    difficulty: 'medium',
    question: 'How do you limit playbook execution to a specific group?',
    options: [
      'ansible-playbook site.yml -g webservers',
      'ansible-playbook site.yml --limit webservers',
      'ansible-playbook site.yml --group webservers',
      'ansible-playbook site.yml --only webservers',
    ],
    correctAnswer: 1,
    explanation: 'The --limit flag restricts execution to specific hosts or groups from your inventory.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['commands', 'execution', 'intermediate'],
  },
  {
    id: 'ansible-23',
    levelId: 'ansible',
    difficulty: 'hard',
    question: 'What is the purpose of "block" in Ansible?',
    options: [
      'To comment out tasks',
      'To group tasks and apply common attributes like when, become, or rescue',
      'To define functions',
      'To create parallel execution groups',
    ],
    correctAnswer: 1,
    explanation: 'Blocks group tasks together to apply common properties, and enable error handling with rescue and always sections.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['blocks', 'error-handling', 'advanced'],
  },
  {
    id: 'ansible-24',
    levelId: 'ansible',
    difficulty: 'hard',
    question: 'How do you make an Ansible task fail gracefully and continue?',
    options: [
      'continue_on_error: true',
      'ignore_errors: yes',
      'fail_safe: true',
      'catch_error: continue',
    ],
    correctAnswer: 1,
    explanation: 'ignore_errors: yes allows the playbook to continue even if the task fails, useful for non-critical tasks.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['error-handling', 'execution', 'advanced'],
  },
  {
    id: 'ansible-25',
    levelId: 'ansible',
    difficulty: 'evil',
    question: 'You need to deploy to 1000 servers but the playbook is too slow. What are the BEST optimizations?',
    options: [
      'Run on a faster control node',
      'Increase forks, use pipelining, disable gather_facts if not needed, use async',
      'Split into 1000 separate playbooks',
      'Use Ansible Tower only, CLI doesn\'t scale',
    ],
    correctAnswer: 1,
    explanation: 'Key optimizations: increase forks (parallel execution), enable pipelining, disable unnecessary fact gathering, use async for long tasks, and use strategy: free.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 50,
    tags: ['performance', 'scaling', 'evil'],
  },
];
