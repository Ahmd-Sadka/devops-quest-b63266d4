import { Question } from '@/types/game';

const wrongFeedbackPool = [
  "Oops! That would definitely page the on-call team at 3 AM ðŸ˜…",
  "Nice try! But production would be crying right now ðŸ˜­",
  "A real DevOps engineer fails fast and learns faster ðŸš€",
  "Close! But that's how you get a Slack message at dinner ðŸ",
  "Hmm, that's how incidents start... ðŸš¨",
  "Your future self would debug this for hours ðŸ•",
  "The logs would be very confused right now ðŸ“œ",
  "That's a spicy way to break things! ðŸŒ¶ï¸",
  "Production would like to have a word with you ðŸ’¬",
  "Stack Overflow would judge you for this one ðŸ‘€",
];

const getRandomWrongFeedback = (): string[] => {
  const shuffled = [...wrongFeedbackPool].sort(() => 0.5 - Math.random());
  return shuffled.slice(0, 3);
};

// Additional questions for existing levels to expand the bank

export const additionalLinuxQuestions: Question[] = [
  {
    id: 'linux-21',
    levelId: 'linux',
    difficulty: 'medium',
    question: 'What does the command "lsof -i :80" show?',
    options: [
      'Lists all files with 80 in the name',
      'Shows processes using port 80',
      'Lists 80 largest files',
      'Shows 80 most recent files',
    ],
    correctAnswer: 1,
    explanation: 'lsof (list open files) with -i :80 shows all processes that have port 80 open.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['networking', 'processes', 'intermediate'],
  },
  {
    id: 'linux-22',
    levelId: 'linux',
    difficulty: 'hard',
    question: 'What is the purpose of the /proc filesystem?',
    options: [
      'Stores procedure documentation',
      'Virtual filesystem exposing kernel and process information',
      'Backup location for system files',
      'Processor configuration files',
    ],
    correctAnswer: 1,
    explanation: '/proc is a virtual filesystem that provides information about running processes and kernel parameters.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['filesystem', 'kernel', 'advanced'],
  },
  {
    id: 'linux-23',
    levelId: 'linux',
    difficulty: 'medium',
    question: 'How do you check disk usage of the current directory?',
    options: [
      'df .',
      'du -sh .',
      'disk --usage .',
      'ls --size .',
    ],
    correctAnswer: 1,
    explanation: 'du -sh . shows disk usage summary (-s) in human-readable format (-h) for the current directory.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['disk', 'commands', 'intermediate'],
  },
  {
    id: 'linux-24',
    levelId: 'linux',
    difficulty: 'hard',
    question: 'What does "nohup command &" accomplish?',
    options: [
      'Runs command with no output',
      'Runs command in background, immune to hangup signals',
      'Runs command with elevated privileges',
      'Runs command without network',
    ],
    correctAnswer: 1,
    explanation: 'nohup prevents the command from receiving SIGHUP when the terminal closes, & runs it in background.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['processes', 'signals', 'advanced'],
  },
  {
    id: 'linux-25',
    levelId: 'linux',
    difficulty: 'evil',
    question: 'A server has 100% CPU usage. How do you identify the culprit process AND its child processes?',
    options: [
      'top',
      'ps aux --sort=-%cpu | head && pstree -p $(pidof process)',
      'htop only',
      'cat /proc/cpuinfo',
    ],
    correctAnswer: 1,
    explanation: 'ps aux sorted by CPU shows the top consumers, then pstree shows the process tree. Combine both for full picture.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 50,
    tags: ['troubleshooting', 'processes', 'evil'],
  },
];

export const additionalBashQuestions: Question[] = [
  {
    id: 'bash-21',
    levelId: 'bash',
    difficulty: 'medium',
    question: 'What does "set -o pipefail" do?',
    options: [
      'Makes pipes work faster',
      'Returns the exit status of the last failed command in a pipeline',
      'Prevents pipes from being used',
      'Logs all pipe operations',
    ],
    correctAnswer: 1,
    explanation: 'Without pipefail, a pipeline returns the exit status of the last command. With pipefail, it returns the status of the first failed command.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['error-handling', 'pipes', 'intermediate'],
  },
  {
    id: 'bash-22',
    levelId: 'bash',
    difficulty: 'hard',
    question: 'What is the difference between $@ and $* in Bash?',
    options: [
      'No difference',
      '$@ preserves each argument as separate, $* combines all into one string',
      '$@ is for arrays, $* is for strings',
      '$* is deprecated',
    ],
    correctAnswer: 1,
    explanation: 'When quoted: "$@" expands each argument as a separate word, "$*" combines all arguments into a single string.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['arguments', 'variables', 'advanced'],
  },
  {
    id: 'bash-23',
    levelId: 'bash',
    difficulty: 'medium',
    question: 'How do you read a file line by line in Bash?',
    options: [
      'for line in file.txt; do echo $line; done',
      'while IFS= read -r line; do echo "$line"; done < file.txt',
      'cat file.txt | foreach line',
      'read file.txt line by line',
    ],
    correctAnswer: 1,
    explanation: 'while read with IFS= preserves whitespace and -r prevents backslash interpretation. Input redirection feeds the file.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['files', 'loops', 'intermediate'],
  },
  {
    id: 'bash-24',
    levelId: 'bash',
    difficulty: 'hard',
    question: 'What does "trap cleanup EXIT" do?',
    options: [
      'Catches syntax errors',
      'Runs the cleanup function when the script exits',
      'Prevents the script from exiting',
      'Logs exit attempts',
    ],
    correctAnswer: 1,
    explanation: 'trap allows you to run commands when the script receives signals. EXIT runs the command when the script exits for any reason.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['signals', 'cleanup', 'advanced'],
  },
  {
    id: 'bash-25',
    levelId: 'bash',
    difficulty: 'evil',
    question: 'Your script works but produces "Argument list too long" with 100k files. How do you fix it?',
    code: 'rm /logs/*.log  # fails with too many files',
    options: [
      'Use rm -f',
      'Use find with -delete or xargs',
      'Increase ulimit',
      'Split into smaller directories',
    ],
    correctAnswer: 1,
    explanation: 'When glob expansion exceeds ARG_MAX, use find /logs -name "*.log" -delete or find ... | xargs rm to process in batches.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 50,
    tags: ['limits', 'troubleshooting', 'evil'],
  },
];

export const additionalGitQuestions: Question[] = [
  {
    id: 'git-21',
    levelId: 'git',
    difficulty: 'medium',
    question: 'What does "git stash" do?',
    options: [
      'Permanently deletes uncommitted changes',
      'Temporarily saves uncommitted changes for later',
      'Creates a new branch',
      'Commits changes with a default message',
    ],
    correctAnswer: 1,
    explanation: 'git stash temporarily saves your working directory changes so you can switch branches, then apply them later with git stash pop.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['stash', 'workflow', 'intermediate'],
  },
  {
    id: 'git-22',
    levelId: 'git',
    difficulty: 'hard',
    question: 'How do you undo the last commit but keep the changes?',
    options: [
      'git reset --hard HEAD~1',
      'git reset --soft HEAD~1',
      'git revert HEAD',
      'git undo',
    ],
    correctAnswer: 1,
    explanation: '--soft keeps changes staged, --mixed (default) unstages them, --hard discards them. HEAD~1 means one commit back.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['reset', 'undo', 'advanced'],
  },
  {
    id: 'git-23',
    levelId: 'git',
    difficulty: 'medium',
    question: 'What is the purpose of .gitignore?',
    options: [
      'Lists ignored commits',
      'Specifies files/patterns Git should not track',
      'Ignores merge conflicts',
      'Skips certain branches',
    ],
    correctAnswer: 1,
    explanation: '.gitignore tells Git which files/directories to exclude from version control (like node_modules, build files, secrets).',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['config', 'basics', 'intermediate'],
  },
  {
    id: 'git-24',
    levelId: 'git',
    difficulty: 'hard',
    question: 'What does "git bisect" help you do?',
    options: [
      'Split a repository in half',
      'Binary search through commits to find which introduced a bug',
      'Divide branches equally',
      'Compare two files',
    ],
    correctAnswer: 1,
    explanation: 'git bisect performs a binary search through your commit history to efficiently find which commit introduced a bug.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['debugging', 'history', 'advanced'],
  },
  {
    id: 'git-25',
    levelId: 'git',
    difficulty: 'evil',
    question: 'You accidentally pushed secrets to a public repo. How do you COMPLETELY remove them from history?',
    options: [
      'Delete the file and push again',
      'git filter-branch or BFG Repo-Cleaner, then force push and rotate the secrets',
      'Make the repo private',
      'Create a new commit removing the file',
    ],
    correctAnswer: 1,
    explanation: 'Secrets remain in Git history! You must rewrite history with filter-branch/BFG, force push, AND rotate the leaked credentials immediately.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 50,
    tags: ['security', 'history', 'evil'],
  },
];

export const additionalDockerQuestions: Question[] = [
  {
    id: 'docker-21',
    levelId: 'docker',
    difficulty: 'medium',
    question: 'What is a Docker layer?',
    options: [
      'A security level in Docker',
      'A read-only filesystem that makes up part of an image',
      'A network configuration',
      'A container priority level',
    ],
    correctAnswer: 1,
    explanation: 'Docker images consist of layers, each representing a Dockerfile instruction. Layers are cached and reused for efficiency.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['images', 'layers', 'intermediate'],
  },
  {
    id: 'docker-22',
    levelId: 'docker',
    difficulty: 'hard',
    question: 'What is the difference between ENTRYPOINT and CMD?',
    options: [
      'They are the same',
      'ENTRYPOINT is the main command, CMD provides default arguments that can be overridden',
      'CMD runs first, then ENTRYPOINT',
      'ENTRYPOINT is deprecated',
    ],
    correctAnswer: 1,
    explanation: 'ENTRYPOINT sets the main executable. CMD provides default arguments. When both exist, CMD args are appended to ENTRYPOINT.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['dockerfile', 'commands', 'advanced'],
  },
  {
    id: 'docker-23',
    levelId: 'docker',
    difficulty: 'medium',
    question: 'How do you limit a container to use maximum 512MB of memory?',
    options: [
      'docker run --ram 512m',
      'docker run --memory 512m',
      'docker run --max-mem 512m',
      'docker run --limit-memory 512m',
    ],
    correctAnswer: 1,
    explanation: '--memory (or -m) limits the container memory. You can also set --memory-swap for total memory including swap.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['resources', 'limits', 'intermediate'],
  },
  {
    id: 'docker-24',
    levelId: 'docker',
    difficulty: 'hard',
    question: 'What is the purpose of Docker health checks?',
    options: [
      'To check Docker daemon health',
      'To verify container is running and application is healthy',
      'To monitor disk usage',
      'To check network connectivity',
    ],
    correctAnswer: 1,
    explanation: 'HEALTHCHECK instruction lets Docker periodically check if the container application is healthy, not just running.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['healthcheck', 'monitoring', 'advanced'],
  },
  {
    id: 'docker-25',
    levelId: 'docker',
    difficulty: 'evil',
    question: 'Your Docker image is 2GB. How do you reduce it significantly?',
    options: [
      'Use COMPRESS instruction',
      'Multi-stage builds, alpine base, minimize layers, remove build dependencies',
      'Use docker compact command',
      'Split into multiple smaller images',
    ],
    correctAnswer: 1,
    explanation: 'Multi-stage builds copy only needed artifacts, alpine is ~5MB vs ~100MB for Debian, and cleaning up in the same layer prevents bloat.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 50,
    tags: ['optimization', 'images', 'evil'],
  },
];

export const additionalDevOpsQuestions: Question[] = [
  {
    id: 'devops-21',
    levelId: 'devops',
    difficulty: 'medium',
    question: 'What is GitOps?',
    options: [
      'Using Git for code only',
      'Using Git as the single source of truth for declarative infrastructure and applications',
      'A Git hosting platform',
      'Git operations automation',
    ],
    correctAnswer: 1,
    explanation: 'GitOps uses Git repos as the source of truth for infrastructure. Changes are made via PRs and automatically synced to clusters.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['gitops', 'practices', 'intermediate'],
  },
  {
    id: 'devops-22',
    levelId: 'devops',
    difficulty: 'hard',
    question: 'What is the purpose of a service mesh?',
    options: [
      'Network cable management',
      'Manages service-to-service communication with traffic management, security, and observability',
      'Database connection pooling',
      'Load balancer configuration',
    ],
    correctAnswer: 1,
    explanation: 'Service meshes (Istio, Linkerd) handle microservices networking: mTLS, traffic routing, circuit breaking, and distributed tracing.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['microservices', 'networking', 'advanced'],
  },
  {
    id: 'devops-23',
    levelId: 'devops',
    difficulty: 'medium',
    question: 'What does "shift left" mean in DevOps?',
    options: [
      'Move servers to a different region',
      'Move testing and security earlier in the development lifecycle',
      'Decrease development time',
      'Left-align code formatting',
    ],
    correctAnswer: 1,
    explanation: 'Shift left means addressing testing, security, and quality earlier in development rather than waiting until deployment.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 20,
    tags: ['practices', 'culture', 'intermediate'],
  },
  {
    id: 'devops-24',
    levelId: 'devops',
    difficulty: 'hard',
    question: 'What is the purpose of a chaos engineering tool like Chaos Monkey?',
    options: [
      'To create random bugs in code',
      'To randomly terminate instances to test system resilience',
      'To generate test data',
      'To simulate high traffic',
    ],
    correctAnswer: 1,
    explanation: 'Chaos engineering intentionally introduces failures to verify systems can withstand turbulent conditions in production.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 35,
    tags: ['chaos', 'resilience', 'advanced'],
  },
  {
    id: 'devops-25',
    levelId: 'devops',
    difficulty: 'evil',
    question: 'Interview: How would you design a zero-downtime deployment strategy for a stateful application with a database?',
    options: [
      'Blue-green deployment only',
      'Rolling deployment with backward-compatible DB migrations, feature flags, and canary releases',
      'Stop all traffic, deploy, restart',
      'Use read replicas only',
    ],
    correctAnswer: 1,
    explanation: 'Stateful apps need expand-contract DB migrations, feature flags for new code paths, rolling updates, and canary validation.',
    wrongFeedback: getRandomWrongFeedback(),
    xpReward: 50,
    tags: ['deployment', 'interview', 'evil'],
  },
];
